function SelectDateById(e,t,n,a){var o=document.getElementById(e);return null==o?!1:(o.focus(),void(null!=o.onclick?o.onclick():null!=o.click?o.click():SelectDate(o,t,n,a)))}function SelectDate(e,t,n,a){leftX=null==n?leftX:n,topY=null==a?topY:a,null==document.getElementById("ContainerPanel")&&InitContainerPanel();var o=new Date,r=o.getFullYear()-50,l=o.getFullYear()+50;cal=null==cal?new Calendar(r,l,0):cal,cal.DateMode=pickMode.second,t.indexOf("s")<0&&(cal.DateMode=pickMode.minute),t.indexOf("m")<0&&(cal.DateMode=pickMode.hour),t.indexOf("h")<0&&(cal.DateMode=pickMode.day),t.indexOf("d")<0&&(cal.DateMode=pickMode.month),t.indexOf("M")<0&&(cal.DateMode=pickMode.year),t.indexOf("y")<0&&(cal.DateMode=pickMode.second),cal.dateFormatStyleOld=cal.dateFormatStyle,cal.dateFormatStyle=t,cal.show(e)}function Calendar(e,t,n,a){this.beginYear=1950,this.endYear=2050,this.lang=0,this.dateFormatStyle="yyyy-MM-dd hh:mm:ss",null!=e&&null!=t&&(this.beginYear=e,this.endYear=t),null!=n&&(this.lang=n),null!=a&&(this.dateFormatStyle=a),this.dateControl=null,this.panel=this.getElementById("calendarPanel"),this.container=this.getElementById("ContainerPanel"),this.form=null,this.date=new Date,this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.day=this.date.getDate(),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.second=this.date.getSeconds(),this.colors={cur_word:"#FFFFFF",cur_bg:"#00FF00",sel_bg:"#FFCCCC",sun_word:"#333",sat_word:"#333",td_word_light:"#333333",td_word_dark:"#CCCCCC",td_bg_out:"#EFEFEF",td_bg_over:"#FFCC00",tr_word:"#FFFFFF",tr_bg:"#666666",input_border:"#CCCCCC",input_bg:"#EFEFEF"}}function InitContainerPanel(){var e='<div id="calendarPanel" style="position: absolute;display: none;z-index:9999; background-color: #FFFFFF;border: 1px solid #CCCCCC;width:175px;font-size:12px;"></div>';document.all&&(e+='<iframe style="position:absolute;z-index:2000;width:expression(this.previousSibling.offsetWidth);',e+="height:expression(this.previousSibling.offsetHeight);",e+="left:expression(this.previousSibling.offsetLeft);top:expression(this.previousSibling.offsetTop);",e+='display:expression(this.previousSibling.style.display);" scrolling="no" frameborder="no"></iframe>');var t=document.createElement("div");t.innerHTML=e,t.id="ContainerPanel",t.style.display="none",document.body.appendChild(t)}var cal,isFocus=!1,pickMode={second:1,minute:2,hour:3,day:4,month:5,year:6},topY=0,leftX=0;String.prototype.toDate=function(style){var y=this.substring(style.indexOf("y"),style.lastIndexOf("y")+1),M=this.substring(style.indexOf("M"),style.lastIndexOf("M")+1),d=this.substring(style.indexOf("d"),style.lastIndexOf("d")+1),h=this.substring(style.indexOf("h"),style.lastIndexOf("h")+1),m=this.substring(style.indexOf("m"),style.lastIndexOf("m")+1),s=this.substring(style.indexOf("s"),style.lastIndexOf("s")+1);(null==s||""==s||isNaN(s))&&(s=(new Date).getSeconds()),(null==m||""==m||isNaN(m))&&(m=(new Date).getMinutes()),(null==h||""==h||isNaN(h))&&(h=(new Date).getHours()),(null==d||""==d||isNaN(d))&&(d=(new Date).getDate()),(null==M||""==M||isNaN(M))&&(M=(new Date).getMonth()+1),(null==y||""==y||isNaN(y))&&(y=(new Date).getFullYear());var dt;return eval("dt = new Date('"+y+"', '"+(M-1)+"','"+d+"','"+h+"','"+m+"','"+s+"')"),dt},Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"w+":"天一二三四五六".charAt(this.getDay()),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in t)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[n]:("00"+t[n]).substr((""+t[n]).length)));return e},Calendar.prototype.ReturnDate=function(e){if(null!=this.dateControl&&(this.dateControl.value=e),calendar.hide(),null!=this.dateControl.onchange){var t=this.dateControl.onchange.toString();t=t.substring(t.indexOf("ValidatorOnChange();")>0?t.indexOf("ValidatorOnChange();")+20:t.indexOf("{")+1,t.lastIndexOf("}"));var n=new Function(t);this.dateControl.changeEvent=n,this.dateControl.changeEvent()}},Calendar.language={year:[[""],[""]],months:[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]],weeks:[["日","一","二","三","四","五"," 六"],["SUN","MON","TUR","WED","THU","FRI","SAT"]],hour:[["时"],["H"]],minute:[["分"],["M"]],second:[["秒"],["S"]],clear:[["清空"],["CLS"]],today:[["今天"],["TODAY"]],pickTxt:[["确定"],["OK"]],close:[["关闭"],["CLOSE"]]},Calendar.prototype.draw=function(){calendar=this;var mvAry=[];mvAry[mvAry.length]=' <div name="calendarForm" style="margin: 0px;">',mvAry[mvAry.length]='    <table width="100%" border="0" cellpadding="0" cellspacing="1" style="font-size:12px;">',mvAry[mvAry.length]="      <tr>",mvAry[mvAry.length]='        <th align="left" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+";width:16px;height:20px;",calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" name="prevMonth" type="button" id="prevMonth" value="&lt;" /></th>',mvAry[mvAry.length]='        <th align="center" width="98%" nowrap="nowrap"><select name="calendarYear" id="calendarYear" style="font-size:12px;"></select><select name="calendarMonth" id="calendarMonth" style="font-size:12px;',calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"></select></th>',mvAry[mvAry.length]='        <th align="right" width="1%"><input style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+";width:16px;height:20px;",calendar.DateMode>pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" name="nextMonth" type="button" id="nextMonth" value="&gt;" /></th>',mvAry[mvAry.length]="      </tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]='    <table id="calendarTable" width="100%" style="border:0px solid #CCCCCC;background-color:#FFFFFF;font-size:12px;',calendar.DateMode>=pickMode.month&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='" border="0" cellpadding="3" cellspacing="1">',mvAry[mvAry.length]="      <tr>";for(var i=0;7>i;i++)mvAry[mvAry.length]='      <th style="font-weight:normal;background-color:'+calendar.colors.tr_bg+";color:"+calendar.colors.tr_word+';">'+Calendar.language.weeks[this.lang][i]+"</th>";mvAry[mvAry.length]="      </tr>";for(var i=0;6>i;i++){mvAry[mvAry.length]='    <tr align="center">';for(var j=0;7>j;j++)0==j?mvAry[mvAry.length]=' <td style="cursor:default;color:'+calendar.colors.sun_word+';"></td>':6==j?mvAry[mvAry.length]=' <td style="cursor:default;color:'+calendar.colors.sat_word+';"></td>':mvAry[mvAry.length]=' <td style="cursor:default;"></td>';mvAry[mvAry.length]="    </tr>"}mvAry[mvAry.length]='      <tr style="',calendar.DateMode>=pickMode.day&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><td align="center" colspan="7">',mvAry[mvAry.length]='      <select name="calendarHour" id="calendarHour" style="font-size:12px;"></select>'+Calendar.language.hour[this.lang],mvAry[mvAry.length]='<span style="',calendar.DateMode>=pickMode.hour&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><select name="calendarMinute" id="calendarMinute" style="font-size:12px;"></select>'+Calendar.language.minute[this.lang]+"</span>",mvAry[mvAry.length]='<span style="',calendar.DateMode>=pickMode.minute&&(mvAry[mvAry.length]="display:none;"),mvAry[mvAry.length]='"><select name="calendarSecond" id="calendarSecond" style="font-size:12px;"></select>'+Calendar.language.second[this.lang]+"</span>",mvAry[mvAry.length]="      </td></tr>",mvAry[mvAry.length]="    </table>",mvAry[mvAry.length]='      <div align="center" style="padding:4px 4px 4px 4px;background-color:'+calendar.colors.input_bg+';">',mvAry[mvAry.length]='        <input name="calendarClear" type="button" id="calendarClear" value="'+Calendar.language.clear[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:40px;height:20px;font-size:12px;cursor:pointer;"/>',mvAry[mvAry.length]='        <input name="calendarToday" type="button" id="calendarToday" value="',mvAry[mvAry.length]=calendar.DateMode==pickMode.day?Calendar.language.today[this.lang]:Calendar.language.pickTxt[this.lang],mvAry[mvAry.length]='" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:60px;height:20px;font-size:12px;cursor:pointer"/>',mvAry[mvAry.length]='        <input name="calendarClose" type="button" id="calendarClose" value="'+Calendar.language.close[this.lang]+'" style="border: 1px solid '+calendar.colors.input_border+";background-color:"+calendar.colors.input_bg+';width:40px;height:20px;font-size:12px;cursor:pointer"/>',mvAry[mvAry.length]="      </div>",mvAry[mvAry.length]=" </div>",this.panel.innerHTML=mvAry.join("");var obj=this.getElementById("prevMonth");with(obj.onclick=function(){calendar.goPrevMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.prevMonth=obj,obj=this.getElementById("nextMonth"),obj.onclick=function(){calendar.goNextMonth(calendar)},obj.onblur=function(){calendar.onblur()},this.nextMonth=obj,obj=this.getElementById("calendarClear"),obj.onclick=function(){calendar.ReturnDate("")},this.calendarClear=obj,obj=this.getElementById("calendarClose"),obj.onclick=function(){calendar.hide()},this.calendarClose=obj,obj=this.getElementById("calendarYear"),obj.onchange=function(){calendar.update(calendar)},obj.onblur=function(){calendar.onblur()},this.calendarYear=obj,obj=this.getElementById("calendarMonth"))onchange=function(){calendar.update(calendar)},onblur=function(){calendar.onblur()};this.calendarMonth=obj,obj=this.getElementById("calendarHour"),obj.onchange=function(){calendar.hour=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarHour=obj,obj=this.getElementById("calendarMinute"),obj.onchange=function(){calendar.minute=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarMinute=obj,obj=this.getElementById("calendarSecond"),obj.onchange=function(){calendar.second=this.options[this.selectedIndex].value},obj.onblur=function(){calendar.onblur()},this.calendarSecond=obj,obj=this.getElementById("calendarToday"),obj.onclick=function(){var e=calendar.DateMode!=pickMode.day?new Date(calendar.year,calendar.month,calendar.day,calendar.hour,calendar.minute,calendar.second):new Date;calendar.ReturnDate(e.format(calendar.dateFormatStyle))},this.calendarToday=obj},Calendar.prototype.bindYear=function(){var e=this.calendarYear;e.length=0;for(var t=this.beginYear;t<=this.endYear;t++)e.options[e.length]=new Option(t+Calendar.language.year[this.lang],t)},Calendar.prototype.bindMonth=function(){var e=this.calendarMonth;e.length=0;for(var t=0;12>t;t++)e.options[e.length]=new Option(Calendar.language.months[this.lang][t],t)},Calendar.prototype.bindHour=function(){var e=this.calendarHour;if(!(e.length>0))for(var t,n=0;24>n;n++)t=("00"+n).substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.bindMinute=function(){var e=this.calendarMinute;if(!(e.length>0))for(var t,n=0;60>n;n++)t=("00"+n).substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.bindSecond=function(){var e=this.calendarSecond;if(!(e.length>0))for(var t,n=0;60>n;n++)t=("00"+n).substr((""+n).length),e.options[e.length]=new Option(t,t)},Calendar.prototype.goPrevMonth=function(e){(this.year!=this.beginYear||0!=this.month)&&(this.month--,-1==this.month&&(this.year--,this.month=11),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData())},Calendar.prototype.goNextMonth=function(e){(this.year!=this.endYear||11!=this.month)&&(this.month++,12==this.month&&(this.year++,this.month=0),this.date=new Date(this.year,this.month,1),this.changeSelect(),this.bindData())},Calendar.prototype.changeSelect=function(){var e=this.calendarYear,t=this.calendarMonth,n=this.calendarHour,a=this.calendarMinute,o=this.calendarSecond;e[this.date.getFullYear()-this.beginYear].selected=!0,t[this.date.getMonth()].selected=!0,n[this.hour].selected=!0,a[this.minute].selected=!0,o[this.second].selected=!0},Calendar.prototype.update=function(e){this.year=e.calendarYear.options[e.calendarYear.selectedIndex].value,this.month=e.calendarMonth.options[e.calendarMonth.selectedIndex].value,this.date=new Date(this.year,this.month,1),this.bindData()},Calendar.prototype.bindData=function(){var e=this;if(!(e.DateMode>=pickMode.month))for(var t=this.getMonthViewArray(this.date.getFullYear(),this.date.getMonth()),n=this.getElementById("calendarTable").getElementsByTagName("td"),a=0;a<n.length&&(n[a].style.backgroundColor=e.colors.td_bg_out,n[a].onclick=function(){},n[a].onmouseover=function(){},n[a].onmouseout=function(){},!(a>t.length-1));a++)if(n[a].innerHTML=t[a],"&nbsp;"!=t[a]){n[a].bgColorTxt="td_bg_out";var o=new Date;n[a].isToday=!1,o.getFullYear()==e.date.getFullYear()&&o.getMonth()==e.date.getMonth()&&o.getDate()==t[a]&&(n[a].style.backgroundColor=e.colors.cur_bg,n[a].bgColorTxt="cur_bg",n[a].isToday=!0),null!=e.dateControl&&(o=e.dateControl.value.toDate(e.dateFormatStyle),o.getFullYear()==e.date.getFullYear()&&o.getMonth()==e.date.getMonth()&&o.getDate()==t[a]&&(e.selectedDayTD=n[a],n[a].style.backgroundColor=e.colors.sel_bg,n[a].bgColorTxt="sel_bg")),n[a].onclick=function(){e.DateMode==pickMode.day?e.ReturnDate(new Date(e.date.getFullYear(),e.date.getMonth(),this.innerHTML).format(e.dateFormatStyle)):(null!=e.selectedDayTD&&(e.selectedDayTD.style.backgroundColor=e.selectedDayTD.isToday?e.colors.cur_bg:e.colors.td_bg_out),this.style.backgroundColor=e.colors.sel_bg,e.day=this.innerHTML,e.selectedDayTD=this)},n[a].style.cursor="pointer",n[a].onmouseover=function(){this.style.backgroundColor=e.colors.td_bg_over},n[a].onmouseout=function(){e.selectedDayTD!=this&&(this.style.backgroundColor=e.colors[this.bgColorTxt])},n[a].onblur=function(){e.onblur()}}},Calendar.prototype.getMonthViewArray=function(e,t){for(var n=[],a=new Date(e,t,1).getDay(),o=new Date(e,t+1,0).getDate(),r=0;42>r;r++)n[r]="&nbsp;";for(var r=0;o>r;r++)n[r+a]=r+1;return n},Calendar.prototype.getElementById=function(id){if("string"!=typeof id||""==id)return null;if(document.getElementById)return document.getElementById(id);if(document.all)return document.all(id);try{return eval(id)}catch(e){return null}},Calendar.prototype.getElementsByTagName=function(e,t){return document.getElementsByTagName?document.getElementsByTagName(t):document.all?document.all.tags(t):void 0},Calendar.prototype.getAbsPoint=function(e){for(var t=e.offsetLeft,n=e.offsetTop;e=e.offsetParent;)t+=e.offsetLeft,n+=e.offsetTop;return{x:t,y:n}},Calendar.prototype.show=function(e,t){if(null==e)throw new Error("arguments[0] is necessary");this.dateControl=e;var n=new Date;this.date=e.value.length>0?new Date(e.value.toDate(this.dateFormatStyle)):n.format(this.dateFormatStyle).toDate(this.dateFormatStyle),(""==this.panel.innerHTML||cal.dateFormatStyleOld!=cal.dateFormatStyle)&&(this.draw(),this.bindYear(),this.bindMonth(),this.bindHour(),this.bindMinute(),this.bindSecond()),this.year=this.date.getFullYear(),this.month=this.date.getMonth(),this.day=this.date.getDate(),this.hour=this.date.getHours(),this.minute=this.date.getMinutes(),this.second=this.date.getSeconds(),this.changeSelect(),this.bindData(),null==t&&(t=e);var a=this.getAbsPoint(t);this.panel.style.left=a.x+leftX+"px",this.panel.style.top=a.y+topY+e.offsetHeight+"px",this.panel.style.display="",this.container.style.display="",this.dateControl.isTransEvent||(this.dateControl.isTransEvent=!0,null!=this.dateControl.onblur&&(this.dateControl.blurEvent=this.dateControl.onblur),this.dateControl.onblur=function(){calendar.onblur(),"function"==typeof this.blurEvent&&this.blurEvent()}),this.container.onmouseover=function(){isFocus=!0},this.container.onmouseout=function(){isFocus=!1}},Calendar.prototype.hide=function(){this.panel.style.display="none",this.container.style.display="none",isFocus=!1},Calendar.prototype.onblur=function(){isFocus||this.hide()};